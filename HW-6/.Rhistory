setwd('~/Documents/Applied-Machine-Learning/HW-7/')
library("MASS", lib.loc="/usr/lib/R/library")
data <- read.table('housing_data.txt', header = FALSE)
View(data)
View(data)
View(data)
data.lm <- lm(data$V14~data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
plot(data.lm)
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
plot(data.lm)
par(mfrow=c(2,2))
plot(data.lm)
plot(data.lm, id.n = 8)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2))
plot(data.lm, id.n = 8)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))
plot(data.lm, id.n = 8)
summary(data.lm)
View(data.lm)
View(data.lm)
summary(data.lm)$r.squared
sum = summary(data.im)
sum = summary(data.lm)
View(sum)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))
plot(data.lm, id.n = 8)
sum = summary(data.lm)
View(data.lm)
View(data.lm)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
# par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
plot(data.lm, id.n = 6)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
# par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
plot(data.lm, id.n = 10)
plot(data.lm, id.n = 6)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 366, 369, 370, 373, 413),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
# par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 6)
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
# par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 3)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
# par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
plot(data.lm, id.n = 6)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 366, 369, 370, 373, 413),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 3)
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 4)
# In the 2nd round, we can spotted that 368, 371, 372, 381 are bit off
data.rm_sec <-data.rm[-c(368, 371, 372, 381),]
data.rm_sec.lm <- lm(data.rm_sec$V14~data.rm_sec$V1+data.rm_sec$V2+data.rm_sec$V3+data.rm_sec$V4+data.rm_sec$V5+data.rm_sec$V6+data.rm_sec$V7+data.rm_sec$V8+data.rm_sec$V9+data.rm_sec$V10+data.rm_sec$V11+data.rm_sec$V12+data.rm_sec$V13, data = data.rm_sec)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 4)
# par(c(0, 0, 2, 0))
plot(data.rm_sec.lm, id.n = 4)
# In the 2nd round, we can spotted that 368, 371, 372, 381 are bit off
data.rm_sec <-data.rm[-c(368, 371, 372, 381),]
data.rm_sec.lm <- lm(data.rm_sec$V14~data.rm_sec$V1+data.rm_sec$V2+data.rm_sec$V3+data.rm_sec$V4+data.rm_sec$V5+data.rm_sec$V6+data.rm_sec$V7+data.rm_sec$V8+data.rm_sec$V9+data.rm_sec$V10+data.rm_sec$V11+data.rm_sec$V12+data.rm_sec$V13, data = data.rm_sec)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm_sec.lm, id.n = 4)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 6)
sum = summary(data.lm)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 366, 369, 370, 373, 413),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 4)
# In the 2nd round, we can spotted that 368, 371, 372, 381 are bit off
data.rm_sec <-data.rm[-c(368, 371, 372, 381),]
data.rm_sec.lm <- lm(data.rm_sec$V14~data.rm_sec$V1+data.rm_sec$V2+data.rm_sec$V3+data.rm_sec$V4+data.rm_sec$V5+data.rm_sec$V6+data.rm_sec$V7+data.rm_sec$V8+data.rm_sec$V9+data.rm_sec$V10+data.rm_sec$V11+data.rm_sec$V12+data.rm_sec$V13, data = data.rm_sec)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm_sec.lm, id.n = 4)
View(data.rm_sec)
View(data.rm_sec)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 10)
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 15)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 366, 369, 370, 373, 413, 381),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 4)
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 10)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 20)
sum = summary(data.lm)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 366, 369, 370, 373, 372, 381, 413),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 10)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 366, 369, 370, 373, 372, 381, 406, 413),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 10)
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 100)
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 1000)
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 497)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 20)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 491)
sum = summary(data.lm)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 506) # Use this line to show all the indices of all the data
sum = summary(data.lm)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 369, 372, 372, 381, 406, 411, 419),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 10)
# Problem B, performing data removal
# 1st round, we know that 365, 366, 369, 370, 373, 413 seems quite off
data.rm <-data[-c(365, 369, 372, 372, 381, 406, 411, 415, 419),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 10)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
#par(c(0, 0, 2, 0))
plot(data.lm, id.n = 506) # Use this line to show all the indices of all the data
sum = summary(data.lm)
sum = summary(data.lm)
# Problem B, performing data removal
# Simply re-run many times of the reduction to finalized the following 9 points
data.rm <-data[-c(365, 369, 372, 372, 381, 406, 411, 415, 419),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
# par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 10)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
#plot(data.lm, id.n = 506) # Use this line to show all the indices of all the data
sum = summary(data.lm)
setwd('~/Documents/Applied-Machine-Learning/HW-7/')
data <- read.table('housing_data.txt', header = FALSE)
# Problem A, starting fiting using the data and plot the graphs
data.lm <- lm(data$V14~data$V1+data$V2+data$V3+data$V4+data$V5+data$V6+data$V7+data$V8+data$V9+data$V10+data$V11+data$V12+data$V13, data = data)
# par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
plot(data.lm, id.n = 506) # Use this line to show all the indices of all the data
# Problem B, performing data removal
# Simply re-run many times of the reduction to finalized the following 9 points
data.rm <-data[-c(365, 369, 370, 372, 372, 381, 406, 411, 415, 419),]
data.rm.lm <- lm(data.rm$V14~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
# par(mfrow=c(2,2), oma = c(0, 0, 2, 0))  # Used for formatting, not necessary here
par(c(0, 0, 2, 0))
plot(data.rm.lm, id.n = 10)
# Problem C
box_cox_result <- boxcox(data.rm.lm)
library(MASS)
# Problem C
box_cox_result <- boxcox(data.rm.lm)
View(box_cox_result)
View(box_cox_result)
best_lam <- box_cox_result$x[which(box_cox_result$y == max(box_cox_result$y))]
View(data.rm.lm)
View(data.rm.lm)
# Problem D
data.box <- (data.rm$V14^best_lam-1)/best_lam
box.lm <- lm(data.box~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
# Plot the original graph
data.stdres = rstandard(data.lm)
plot(data.lm$fitted.values, eruption.stdres,
+     ylab="Standardized Residuals",
+     xlab="Fited Value",
+     main="Raw Data")
plot(data.lm$fitted.values, eruption.stdres, ylab="Standardized Residuals", xlab="Fited Value", main="Raw Data")
plot(data.lm$fitted.values, data.stdres, ylab="Standardized Residuals", xlab="Fited Value", main="Raw Data")
abline(0, 0)                  # the horizon
abline(0, 0, col('red'))                  # the horizon
abline(0, 0, col='red')                  # the horizon
# Plot the processed data
box.stdres = rstandard(box.lm)
box.lm.fitted_retrans = (box.lm$fitted.values*best_lam+1)^(1./best_lam)
plot(box.lm.fitted_retrans, box.stdres, ylab="Standardized Residuals", xlab="Fited Value", main="Raw Data")
plot(box.lm.fitted_retrans, box.stdres, ylab="Standardized Residuals", xlab="Fited Value", main="Processed Data")
abline(0, 0, col='red')                  # the horizon
# Problem C
box_cox_result <- boxcox(data.rm.lm)
best_lam <- box_cox_result$x[which(box_cox_result$y == max(box_cox_result$y))]
# Problem D
data.box <- (data.rm$V14^best_lam-1)/best_lam
box.lm <- lm(data.box~data.rm$V1+data.rm$V2+data.rm$V3+data.rm$V4+data.rm$V5+data.rm$V6+data.rm$V7+data.rm$V8+data.rm$V9+data.rm$V10+data.rm$V11+data.rm$V12+data.rm$V13, data = data.rm)
# Plot the original graph
data.stdres = rstandard(data.lm)
plot(data.lm$fitted.values, data.stdres, ylab="Standardized Residuals", xlab="Fited Value", main="Raw Data")
abline(0, 0, col='red')                  # the horizon
# Plot the processed data
box.stdres = rstandard(box.lm)
box.lm.fitted_retrans = (box.lm$fitted.values*best_lam+1)^(1./best_lam)
plot(box.lm.fitted_retrans, box.stdres, ylab="Standardized Residuals", xlab="Fited Value", main="Processed Data")
abline(0, 0, col='red')                  # the horizon
# Problem E
plot(box.lm.fitted_retrans, data.lm$fitted.values, ylab="True House Price", xlab="Fitted House Price", main="Fitted vs True House Price")
# Problem E
plot(box.lm.fitted_retrans, data.rm.lm$fitted.values, ylab="True House Price", xlab="Fitted House Price", main="Fitted vs True House Price")
abline(1, 1, col='red')
abline(1, 0, col='red')
abline(coef = [1, 0], col='red')
abline(coef = (1, 0), col='red')
abline(1, 1, col='red')
# Problem E
plot(box.lm.fitted_retrans, data.rm.lm$fitted.values, ylab="True House Price", xlab="Fitted House Price", main="Fitted vs True House Price")
abline(1, 1, col='red')
